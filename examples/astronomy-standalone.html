<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>astronomy.js ë…ë¦½ ì‚¬ìš© ì˜ˆì œ</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background: #0d1117;
            color: #c9d1d9;
            line-height: 1.6;
        }
        h1 { color: #58a6ff; }
        h2 { color: #79c0ff; margin-top: 2em; border-bottom: 1px solid #30363d; padding-bottom: 8px; }
        h3 { color: #a5d6ff; }
        pre {
            background: #161b22;
            padding: 16px;
            border-radius: 6px;
            overflow-x: auto;
            border: 1px solid #30363d;
        }
        code { color: #79c0ff; }
        .result {
            background: #1f2937;
            padding: 12px 16px;
            border-radius: 6px;
            margin: 10px 0;
            border-left: 3px solid #58a6ff;
            font-family: monospace;
        }
        .interactive {
            background: #21262d;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        input, select {
            padding: 8px 12px;
            border-radius: 4px;
            border: 1px solid #30363d;
            background: #0d1117;
            color: #c9d1d9;
            margin: 5px;
        }
        button {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            background: #238636;
            color: #fff;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #2ea043; }
        .note {
            background: #0d1117;
            border: 1px solid #3fb950;
            border-radius: 6px;
            padding: 12px;
            margin: 10px 0;
        }
        .note::before {
            content: "ğŸ’¡ ";
        }
    </style>
</head>
<body>
    <h1>astronomy.js ë…ë¦½ ì‚¬ìš© ì˜ˆì œ</h1>

    <p>
        <code>astronomy.js</code>ëŠ” ë³„ìë¦¬íŒê³¼ ë…ë¦½ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì²œë¬¸í•™ ê³„ì‚° ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤.
        ë‹¤ë¥¸ í”„ë¡œì íŠ¸ì—ì„œ ë³µì‚¬í•˜ì—¬ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    </p>

    <div class="note">
        ì´ ëª¨ë“ˆì€ ì™¸ë¶€ ì˜ì¡´ì„± ì—†ì´ ìˆœìˆ˜ JavaScriptë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.
    </div>

    <h2>1. ì„í¬íŠ¸</h2>
    <pre><code>import {
    AstroMath,              // ìƒìˆ˜ ë° ìœ í‹¸ë¦¬í‹°
    AstroTime,              // ì‹œê°„ ë³€í™˜
    AstroVector,            // 3D ë²¡í„°
    AstroMatrix,            // ì¢Œí‘œ ë³€í™˜ í–‰ë ¬
    AstroPoint,             // 2D í¬ì¸íŠ¸
    EquiDistanceProjection  // ë“±ê±°ë¦¬ íˆ¬ì˜
} from './js/src/astronomy.js';</code></pre>

    <h2>2. ë‹¨ìœ„ ë³€í™˜ (AstroMath)</h2>
    <pre><code>// ë„(degree) â†’ ë¼ë””ì•ˆ
const rad = 45 * AstroMath.D2R;  // 0.7854...

// ë¼ë””ì•ˆ â†’ ë„
const deg = Math.PI * AstroMath.R2D;  // 180

// ì‹œ(hour) â†’ ë¼ë””ì•ˆ (ì ê²½ ë³€í™˜ìš©)
const raRad = 6 * AstroMath.H2R;  // 6ì‹œ = Ï€/2 ë¼ë””ì•ˆ

// ê°’ ì •ê·œí™” (ë²”ìœ„ ë‚´ë¡œ ë§ì¶¤)
AstroMath.normalize(450, 0, 360);  // 90
AstroMath.normalize(-30, 0, 360);  // 330
AstroMath.normalize(25, 0, 24);    // 1 (ì‹œê°„)</code></pre>

    <div class="interactive">
        <h3>ë‹¨ìœ„ ë³€í™˜ ê³„ì‚°ê¸°</h3>
        <input type="number" id="degInput" value="45" style="width:80px"> ë„ =
        <span id="radOutput" class="result">0.7854</span> ë¼ë””ì•ˆ
        <button onclick="convertDeg()">ë³€í™˜</button>
    </div>

    <h2>3. ìœ¨ë¦¬ìš°ìŠ¤ì¼ ê³„ì‚° (AstroTime)</h2>
    <pre><code>// ìœ¨ë¦¬ìš°ìŠ¤ì¼ ê³„ì‚°
const jd = AstroTime.jd(2024, 6, 21, 12, 0, 0);
// â†’ 2460482.0 (2024ë…„ í•˜ì§€ ì •ì˜¤)

// J2000.0 ê¸°ì› (2000ë…„ 1ì›” 1ì¼ 12:00)
const j2000 = AstroTime.jd(2000, 1, 1, 12, 0, 0);
// â†’ 2451545.0

// ìœ¤ë…„ íŒë‹¨
AstroTime.isLeapYear(2024);  // true
AstroTime.isLeapYear(2023);  // false
AstroTime.isLeapYear(2000);  // true (400ìœ¼ë¡œ ë‚˜ëˆ„ì–´ì§)
AstroTime.isLeapYear(1900);  // false (100ìœ¼ë¡œ ë‚˜ëˆ„ì–´ì§€ì§€ë§Œ 400ìœ¼ë¡œ ì•ˆ ë‚˜ëˆ„ì–´ì§)</code></pre>

    <div class="interactive">
        <h3>ìœ¨ë¦¬ìš°ìŠ¤ì¼ ê³„ì‚°ê¸°</h3>
        <input type="number" id="jdYear" value="2024" style="width:60px">ë…„
        <input type="number" id="jdMonth" value="6" style="width:40px" min="1" max="12">ì›”
        <input type="number" id="jdDay" value="21" style="width:40px" min="1" max="31">ì¼
        <input type="number" id="jdHour" value="12" style="width:40px" min="0" max="23">ì‹œ
        <button onclick="calcJD()">ê³„ì‚°</button>
        <div id="jdResult" class="result">JD = 2460482.0</div>
    </div>

    <h2>4. ì‹œê°„ ë³€í™˜ ì²´ì¸ (AstroTime)</h2>
    <pre><code>// ì„œìš¸ ê¸°ì¤€ ì‹œê°„ ë³€í™˜ê¸° ìƒì„±
const astroTime = new AstroTime(
    9,       // UTC+9 (í•œêµ­ í‘œì¤€ì‹œ)
    126.98,  // ê²½ë„ (ë™ê²½)
    37.57    // ìœ„ë„ (ë¶ìœ„)
);

// ì§€ë°© í‘œì¤€ì‹œ(LCT) â†’ ì„¸ê³„ì‹œ(UT)
const lct = AstroTime.jd(2024, 6, 21, 21, 0, 0);  // í•œêµ­ ì‹œê°„ 21ì‹œ
const ut = astroTime.LCT2UT(lct);
// â†’ 2024ë…„ 6ì›” 21ì¼ 12:00 UT

// ì„¸ê³„ì‹œ(UT) â†’ ê·¸ë¦¬ë‹ˆì¹˜ í•­ì„±ì‹œ(GST)
const gst = AstroTime.UT2GST(ut);

// ê·¸ë¦¬ë‹ˆì¹˜ í•­ì„±ì‹œ(GST) â†’ ì§€ë°© í•­ì„±ì‹œ(LST)
const lst = astroTime.GST2LST(gst);

// ë˜ëŠ” í•œ ë²ˆì— ë³€í™˜
const lstDirect = astroTime.LCT2LST(lct);</code></pre>

    <h2>5. ì§„ì •ì˜¤ ê³„ì‚° (Local Apparent Solar Noon)</h2>
    <pre><code>const astroTime = new AstroTime(9, 126.98, 37.57);

// 2024ë…„ 6ì›” 21ì¼ ì„œìš¸ì˜ ì§„ì •ì˜¤ ì‹œê°
const solarNoon = astroTime.lasn(2024, 6, 21);
// â†’ ì•½ 12.5ì‹œ (12ì‹œ 30ë¶„ê²½)

// ì§„ì •ìì •
const solarMidnight = astroTime.lamn(2024, 6, 21);
// â†’ ì•½ 0.5ì‹œ (0ì‹œ 30ë¶„ê²½)

// ì‹œê°ë°©ì •ì‹ (ë¶„ ë‹¨ìœ„)
const eot = AstroTime.equationOfTimeMinutes(2024, 2, 11);
// â†’ ì•½ -14ë¶„ (2ì›”ì—ëŠ” íƒœì–‘ì´ í‰ê· ë³´ë‹¤ ëŠ¦ìŒ)</code></pre>

    <div class="interactive">
        <h3>ì§„ì •ì˜¤ ê³„ì‚°ê¸°</h3>
        <input type="number" id="lasnYear" value="2024" style="width:60px">ë…„
        <input type="number" id="lasnMonth" value="6" style="width:40px" min="1" max="12">ì›”
        <input type="number" id="lasnDay" value="21" style="width:40px" min="1" max="31">ì¼
        <br>
        ê²½ë„: <input type="number" id="lasnLon" value="126.98" style="width:70px">Â°
        ì‹œê°„ëŒ€: UTC+<input type="number" id="lasnTz" value="9" style="width:40px">
        <button onclick="calcLASN()">ê³„ì‚°</button>
        <div id="lasnResult" class="result">ì§„ì •ì˜¤: 12:30</div>
    </div>

    <h2>6. ì¢Œí‘œ ë³€í™˜ (AstroVector)</h2>
    <pre><code>// 3D ë²¡í„° ìƒì„±
const vec = new AstroVector(0, 0, 0);

// êµ¬ë©´ ì¢Œí‘œë¡œ ì„¤ì • (ì ê²½, ì ìœ„)
const ra = 2.5 * AstroMath.H2R;    // ì ê²½ 2.5ì‹œ
const dec = 89.26 * AstroMath.D2R; // ì ìœ„ 89.26ë„ (ë¶ê·¹ì„±)
vec.setSphe(ra, dec);

// ì§êµ ì¢Œí‘œ í™•ì¸
console.log(vec.x, vec.y, vec.z);

// ì—­ìœ¼ë¡œ êµ¬ë©´ ì¢Œí‘œ ì¶”ì¶œ
const longitude = vec.lon();  // ë¼ë””ì•ˆ
const latitude = vec.lat();   // ë¼ë””ì•ˆ</code></pre>

    <h2>7. ì ë„â†’ì§€í‰ ì¢Œí‘œ ë³€í™˜</h2>
    <pre><code>// ë¶ê·¹ì„± ì¢Œí‘œ (ì ê²½ 2.5h, ì ìœ„ 89.26Â°)
const polaris = new AstroVector(0, 0, 0);
polaris.setSphe(2.5 * AstroMath.H2R, 89.26 * AstroMath.D2R);

// ì„œìš¸ì—ì„œ ê´€ì¸¡
const lst = astroTime.LCT2LST(AstroTime.jd(2024, 6, 21, 21, 0, 0));
const lat = 37.57 * AstroMath.D2R;

// ì§€í‰ ì¢Œí‘œë¡œ ë³€í™˜
const horizontal = new AstroVector(0, 0, 0);
horizontal.equ2hor(polaris, lst, lat);

// ë°©ìœ„ê°ê³¼ ê³ ë„ ì¶”ì¶œ
const azimuth = horizontal.lon() * AstroMath.R2D;   // ë„
const altitude = horizontal.lat() * AstroMath.R2D;  // ë„
// â†’ ë¶ê·¹ì„±ì˜ ê³ ë„ëŠ” ì•½ 37Â° (ì„œìš¸ ìœ„ë„ì™€ ê±°ì˜ ê°™ìŒ)</code></pre>

    <div class="interactive">
        <h3>ë³„ì˜ ê³ ë„ ê³„ì‚°ê¸°</h3>
        ì ê²½: <input type="number" id="starRA" value="2.5" style="width:60px" step="0.1">ì‹œ
        ì ìœ„: <input type="number" id="starDec" value="89.26" style="width:60px">Â°
        <br>
        ê´€ì¸¡ ìœ„ë„: <input type="number" id="obsLat" value="37.57" style="width:60px">Â°
        <button onclick="calcAltitude()">ê³„ì‚°</button>
        <div id="altResult" class="result">ê³ ë„: 37Â°</div>
    </div>

    <h2>8. ë“±ê±°ë¦¬ íˆ¬ì˜ (EquiDistanceProjection)</h2>
    <pre><code>// íˆ¬ì˜ê¸° ìƒì„± (í™”ë©´ ë°˜ê²½ 300px, ì ìœ„ í•œê³„ -30Â°)
const proj = new EquiDistanceProjection(
    300,                    // í™”ë©´ ë°˜ê²½ (í”½ì…€)
    -30 * AstroMath.D2R     // í‘œì‹œí•  ìµœì € ì ìœ„
);

// ë³„ì˜ ì ê²½/ì ìœ„ë¥¼ í™”ë©´ ì¢Œí‘œë¡œ íˆ¬ì˜
const ra = 6 * AstroMath.H2R;     // ì ê²½ 6ì‹œ
const dec = 45 * AstroMath.D2R;   // ì ìœ„ 45Â°
const screenPos = proj.project(ra, dec);

console.log(screenPos.x, screenPos.y);
// â†’ í™”ë©´ì˜ x, y ì¢Œí‘œ (í”½ì…€)

// ì£¼ì˜: project()ëŠ” ë‚´ë¶€ ê°ì²´ë¥¼ ì¬ì‚¬ìš©í•˜ë¯€ë¡œ
// ê°’ì„ ë³´ì¡´í•˜ë ¤ë©´ ì¦‰ì‹œ ë³µì‚¬í•´ì•¼ í•¨
const savedX = screenPos.x;
const savedY = screenPos.y;</code></pre>

    <h2>9. Node.jsì—ì„œ ì‚¬ìš©</h2>
    <pre><code>// astronomy.jsë¥¼ ë³µì‚¬í•˜ì—¬ ì‚¬ìš©
import { AstroTime, AstroMath } from './astronomy.js';

// í˜„ì¬ ì‹œê°„ì˜ ìœ¨ë¦¬ìš°ìŠ¤ì¼
const now = new Date();
const jd = AstroTime.jd(
    now.getFullYear(),
    now.getMonth() + 1,
    now.getDate(),
    now.getHours(),
    now.getMinutes(),
    now.getSeconds()
);

console.log(`í˜„ì¬ ìœ¨ë¦¬ìš°ìŠ¤ì¼: ${jd.toFixed(6)}`);</code></pre>

    <script type="module">
        import { AstroMath, AstroTime, AstroVector, EquiDistanceProjection } from '../js/src/astronomy.js';

        // ë‹¨ìœ„ ë³€í™˜
        window.convertDeg = function() {
            const deg = parseFloat(document.getElementById('degInput').value);
            const rad = deg * AstroMath.D2R;
            document.getElementById('radOutput').textContent = rad.toFixed(6);
        };

        // ìœ¨ë¦¬ìš°ìŠ¤ì¼ ê³„ì‚°
        window.calcJD = function() {
            const y = parseInt(document.getElementById('jdYear').value);
            const m = parseInt(document.getElementById('jdMonth').value);
            const d = parseInt(document.getElementById('jdDay').value);
            const h = parseInt(document.getElementById('jdHour').value);
            const jd = AstroTime.jd(y, m, d, h, 0, 0);
            const isLeap = AstroTime.isLeapYear(y) ? 'ìœ¤ë…„' : 'í‰ë…„';
            document.getElementById('jdResult').innerHTML = `JD = ${jd.toFixed(6)}<br>(${y}ë…„ì€ ${isLeap})`;
        };

        // ì§„ì •ì˜¤ ê³„ì‚°
        window.calcLASN = function() {
            const y = parseInt(document.getElementById('lasnYear').value);
            const m = parseInt(document.getElementById('lasnMonth').value);
            const d = parseInt(document.getElementById('lasnDay').value);
            const lon = parseFloat(document.getElementById('lasnLon').value);
            const tz = parseInt(document.getElementById('lasnTz').value);

            const astroTime = new AstroTime(tz, lon, 37.57);
            const lasn = astroTime.lasn(y, m, d);
            const hours = Math.floor(lasn);
            const minutes = Math.round((lasn - hours) * 60);
            const eot = AstroTime.equationOfTimeMinutes(y, m, d);

            document.getElementById('lasnResult').innerHTML =
                `ì§„ì •ì˜¤: ${hours}:${minutes.toString().padStart(2, '0')}<br>` +
                `ì‹œê°ë°©ì •ì‹: ${eot > 0 ? '+' : ''}${eot.toFixed(1)}ë¶„`;
        };

        // ë³„ì˜ ê³ ë„ ê³„ì‚°
        window.calcAltitude = function() {
            const ra = parseFloat(document.getElementById('starRA').value) * AstroMath.H2R;
            const dec = parseFloat(document.getElementById('starDec').value) * AstroMath.D2R;
            const obsLat = parseFloat(document.getElementById('obsLat').value) * AstroMath.D2R;

            // ê°„ë‹¨íˆ ìì˜¤ì„  í†µê³¼ ì‹œ ê³ ë„ ê³„ì‚°
            // ìì˜¤ì„  í†µê³¼ ì‹œ ê³ ë„ = 90Â° - |ìœ„ë„ - ì ìœ„|
            const meridianAlt = 90 - Math.abs(obsLat * AstroMath.R2D - dec * AstroMath.R2D);
            const altitudeAtMeridian = meridianAlt;

            // ë¶ê·¹ ê·¼ì²˜ ë³„ì€ í•­ìƒ ì§€í‰ì„  ìœ„
            const circumpolar = dec > (AstroMath.HPI - obsLat);

            document.getElementById('altResult').innerHTML =
                `ìì˜¤ì„  í†µê³¼ ì‹œ ê³ ë„: ${altitudeAtMeridian.toFixed(1)}Â°<br>` +
                (circumpolar ? 'ì£¼ê·¹ì„± (í•­ìƒ ì§€í‰ì„  ìœ„)' : '');
        };

        // ì´ˆê¸° ê³„ì‚° ì‹¤í–‰
        window.convertDeg();
        window.calcJD();
        window.calcLASN();
        window.calcAltitude();
    </script>
</body>
</html>
